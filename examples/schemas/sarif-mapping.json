{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/EPTLLC/brs-recon/schemas/sarif-mapping.json",
  "title": "BRS-RECON SARIF Mapping Configuration",
  "description": "Configuration for mapping BRS-RECON results to SARIF format",
  "type": "object",
  "properties": {
    "tool_info": {
      "type": "object",
      "properties": {
        "name": {"type": "string", "default": "BRS-RECON"},
        "version": {"type": "string"},
        "organization": {"type": "string", "default": "EasyProTech LLC"},
        "informationUri": {"type": "string", "default": "https://github.com/EPTLLC/brs-recon"}
      }
    },
    "rule_mappings": {
      "type": "object",
      "patternProperties": {
        "^[A-Z]+-[0-9]+$": {
          "type": "object",
          "properties": {
            "name": {"type": "string"},
            "shortDescription": {"type": "string"},
            "fullDescription": {"type": "string"},
            "category": {"type": "string"},
            "severity": {"type": "string", "enum": ["low", "medium", "high", "critical"]},
            "cwe": {"type": "string", "pattern": "^CWE-[0-9]+$"},
            "helpUri": {"type": "string", "format": "uri"}
          },
          "required": ["name", "shortDescription", "category", "severity"]
        }
      }
    },
    "severity_mapping": {
      "type": "object",
      "properties": {
        "critical": {"type": "string", "enum": ["error"], "default": "error"},
        "high": {"type": "string", "enum": ["error"], "default": "error"}, 
        "medium": {"type": "string", "enum": ["warning"], "default": "warning"},
        "low": {"type": "string", "enum": ["note", "info"], "default": "note"}
      }
    },
    "module_rules": {
      "type": "object",
      "properties": {
        "vulnerability_scanner": {
          "type": "array",
          "items": {"type": "string"}
        },
        "port_scanning": {
          "type": "array", 
          "items": {"type": "string"}
        },
        "domain_reconnaissance": {
          "type": "array",
          "items": {"type": "string"}
        },
        "network_discovery": {
          "type": "array",
          "items": {"type": "string"}
        },
        "system_information": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    }
  },
  "required": ["tool_info", "rule_mappings", "severity_mapping"]
}
